---
import Layout from "../../layouts/Layout.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import globalText from "../../data/globalText.json";
import { generateBreadcrumbs } from "../../util/generateBreadcrumbs";
import Breadcrumbs from "../../components/Breadcrumbs.astro";
import AboutHeading from "../../components/AboutHeading.astro";
import ServiceCard from "../../components/ServiceCard.astro";
import serviceText from "../../data/serviceText.json";
import { Image } from "astro:assets";
import sorryImage from "/public/assets/sorry.svg";

// const crumbs= [
//   { name: "Home", path: "/" },
//   { name: "Service" }
// ];
const crumbs = generateBreadcrumbs(Astro.url.pathname);

const cardSrc1 = "/riv/web-developer.riv";
const cardSrc2 = "/riv/coding-assets.riv";
const cardSrc3 = "/riv/wordpress.riv";
const cardSrc4 = "/riv/fixing-site.riv";
---

<Layout
  title={globalText.service.title}
  description={globalText.service.description}
  ogType={globalText.local.type}
  ogTitle={globalText.service.title}
  ogDescription={globalText.service.description}
  twitterTitle={globalText.service.title}
  twitterDescription={globalText.service.description}
>
  <div id="outer-container">
    <Header />
    <main id="page-wrap">
      <div class="breadcrumbs__wrapper">
        <Breadcrumbs {crumbs} />
      </div>
      <section class="servicePage">
        <div class="servicePage__wrapper">
          <AboutHeading aboutHeading="Service" />
          <div id="swiper2" class="swiper">
            <!-- <div class="controls">
                <button class="previous" onclick="window.scrollBy(-100, 0)" type="button">
                  previous
                </button>
                <button class="next" onclick="window.scrollBy(100, 0)" type="button">
                  next
                </button>
              </div> -->
            <div class="swiper-wrapper serviceCard__inner">
              <ServiceCard
                cardTitle={serviceText.service.card1.serviceHeader}
                cardBody={serviceText.service.card1.serviceMenu.map((entry) => entry.item)}
                src={cardSrc1}
              />
              <ServiceCard
                cardTitle={serviceText.service.card2.serviceHeader}
                cardBody={serviceText.service.card2.serviceMenu.map((entry) => entry.item)}
                src={cardSrc2}
              />
              <ServiceCard
                cardTitle={serviceText.service.card3.serviceHeader}
                cardBody={serviceText.service.card3.serviceMenu.map((entry) => entry.item)}
                src={cardSrc3}
              />
              <ServiceCard
                cardTitle={serviceText.service.card4.serviceHeader}
                cardBody={serviceText.service.card4.serviceMenu.map((entry) => entry.item)}
                src={cardSrc4}
              />
            </div>
          </div>
        </div>
      </section>
      <hr />
      <hr />
      <section class="pricePage">
        <AboutHeading aboutHeading="Price" />
        {serviceText.price.body.map(({ text }) => <p class="price__body">{text}</p>)}
        <Image
          class="price__image"
          src={sorryImage}
          alt={serviceText.price.imageAlt}
          width="200"
          height="200"
          loading="lazy"
          decoding="async"
        />
        {serviceText.price.footer.map(({ text }) => <p class="price__body" set:html={text} />)}
      </section>
    </main>
    <Footer />
  </div>
</Layout>

<style is:global>
  /* @layer demo.scroll-driven-animation {
    :root {
      overflow-x: auto;
      overscroll-behavior: contain;
      scroll-snap-type: x mandatory;
    }

  } */
  /* :root {
    @supports (animation-timeline: scroll()) {
      animation-timeline: scroll(x);
    }
  }
  :root .body-servicePage > .servicePage {
    scroll-snap-align: start;
  } */
  .body-servicePage {
    /* display: grid; */
    /* grid-auto-flow: column; */
    /* grid-auto-columns: 100vw; */
  }
  .servicePage {
    width: 100%;
    height: 100%;
    display: grid;
    /* place-content: center; */
    grid-template-columns: repeat(auto-fit, minmax(480px, 1fr));
    /* grid-template-columns: repeat(auto-fit, minmax(400px, min(30ch, 25cpi))); */
    /* grid-template-columns: repeat(auto-fit, minmax(40ch, min(30ch, 25cqi))); */
    gap: 1rem;
    overflow: hidden;
    padding: 1rem;
    /* grid-auto-flow: column; */
    /* padding-block-end: 3rem; */
    view-timeline: x;
  }
  .servicePage > * {
    display: grid;
    grid-rows: span 4;
    grid-template-rows: subgrid;
    gap: 2rem;
  }
  .servicePage__wrapper {
    width: 100%;
    max-width: 700px;
    margin-inline: auto;
  }
  #swiper2.swiper {
    width: 100%;
    max-width: 700px;
    height: 100%;
    overflow: hidden;
    border-radius: 1rem;
    /* background-image: url("/assets/pc.svg");
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat; */
    position: relative;
    z-index: 0;
    transition: all 0.3s ease-in;
  }
  /* .controls > button {
    @supports (animation-timeline: scroll()) {
      animation: toggle-control linear both;
    }
  } */
  /* .controls {
    position: fixed;
    z-index: 1;
    inset-block-start: calc(50% - 16px / 2);
    display: flex;
    justify-content: space-between;
  } */
  /* .controls.previous {
    animation-timeline: ;
  } */
  .pricePage {
    border: rebeccapurple 1px solid;
    margin-block-start: 3rem;
    padding-block: 3rem;
  }
  .price__body {
    font-size: 1rem;
    line-height: 2;
    letter-spacing: 0.1em;
    color: inherit;
    text-align: center;
    margin-block-start: 1rem;
  }
  .price__image {
    display: block;
    width: 200px;
    height: 200px;
    object-fit: contain;
    margin-inline: auto;
  }
  .price__link {
    letter-spacing: 0.1em;
    color: rebeccapurple;
    text-align: center;
    margin-block-start: 1rem;
  }
  .price__link_secondary {
    /* display: block; */
    letter-spacing: 0.1em;
    color: rebeccapurple;
    text-align: center;
    margin-block-start: 1rem;
    padding-block: 1rem;
  }
</style>

<script>
  import Swiper from "swiper";
  import { Navigation, Autoplay } from "swiper/modules";
  // Swiper CSSは遅延読み込みされるため、ここではインポートしない

  const initSwiper2 = () => {
    new Swiper("#swiper2", {
      direction: "horizontal",
      modules: [Navigation, Autoplay],
      loop: true,
      effect: "fade",
      speed: 0,
      allowTouchMove: false,
      autoplay: {
        delay: 3000,
        disableOnInteraction: false,
      },
      navigation: {
        nextEl: "#js-mouse",
      },
      on: {
        slideChangeTransitionStart: function () {
          document.querySelectorAll(".swiper-slide img").forEach((img) => {
            img.classList.remove("active");
          });
        },
        slideChangeTransitionEnd: function () {
          const activeSlide = document.querySelector(".swiper-slide-active img");

          if (activeSlide) {
            activeSlide.classList.add("active");
          }
        },
      },
    });
  };

  if (typeof window !== "undefined") {
    initSwiper2();
  }
</script>
